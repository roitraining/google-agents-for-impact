/* -------------------------
   Base / Reset
-------------------------- */
* { margin: 0; padding: 0; box-sizing: border-box; }

:root {
  --page-bg: #ffffff;
  --ink: #0f172a;
  --muted: #64748b;
  --border: #e5e7eb;
  --accent: #1E71D6;
  --user-bubble: #f1f5f9;
  --user-border: #e2e8f0;
}

body {
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  font-size: 16px;
  line-height: 1.6;
  color: var(--ink);
  background: var(--page-bg);
}

/* -------------------------
   Header / Layout
-------------------------- */
.site-header {
  display: flex; align-items: center; justify-content: space-between;
  background-color: var(--accent); color: #fff; padding: 20px;
}
.header-left { display: flex; align-items: center; }
.logo { height: 40px; margin-right: 12px; }

nav a {
  color: #ecf0f1; margin: 0 10px; text-decoration: none; font-weight: 500;
}
nav a:hover { text-decoration: underline; }

main {
  max-width: 90%; margin: auto; padding: 10px; background: #fff;
  border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,.05);
}

h2 { margin-top: 20px; color: #2c3e50; font-size: 24px; font-weight: normal; }
p { margin: 15px 0; }
ol { padding: 20px; }

footer {
  position: fixed; bottom: 0; left: 0; width: 100%;
  background: var(--accent); color: #ccc; text-align: center;
  padding: 10px 0; font-size: 14px;
}

/* -------------------------
   Form Inputs (global)
-------------------------- */
textarea, input[type="text"], input[type="url"] {
  width: 100%; padding: 10px; font-size: 1rem; border: 1px solid #ccc;
  border-radius: 4px; box-sizing: border-box;
}
textarea { resize: vertical; }

button {
  background: var(--accent); color: #fff; border: 0;
  padding: 12px 20px; font-size: 1rem; font-weight: 500;
  border-radius: 6px; cursor: pointer;
  transition: background-color .3s ease, transform .2s ease;
  margin-bottom: 12px;
}
button:hover { background-color: #2980b9; transform: translateY(-1px); }
button:active { background-color: #1c6690; transform: translateY(0); }
button:disabled { background-color: #ccc; cursor: not-allowed; }

hr { margin: 20px 0; }

/* -------------------------
   Spinner
-------------------------- */
#spinner-overlay {
  position: fixed; inset: 0; width: 100vw; height: 100vh;
  background: rgba(255,255,255,.6);
  display: flex; align-items: center; justify-content: center; z-index: 9999;
}
#spinner-overlay.hidden { display: none; }
.spinner {
  width: 60px; height: 60px; border: 6px solid #f3f3f3;
  border-top: 6px solid #3498db; border-radius: 50%;
  animation: spin 1s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* -------------------------
   Tables
-------------------------- */
table {
  width: 100%; border-collapse: collapse; margin-top: 20px;
  background: #fff; border: 1px solid #ddd; font-size: 16px;
  box-shadow: 0 2px 5px rgba(0,0,0,.05); border-radius: 6px; overflow: hidden;
}
th, td { padding: 12px 16px; text-align: left; border-bottom: 1px solid #eee; }
th { background: #f7f7f7; font-weight: 600; color: #333; }
tr:hover { background: #f0f8ff; cursor: pointer; }
td a { color: #007BFF; text-decoration: none; }
td a:hover { text-decoration: underline; }

/* -------------------------
   Modals
-------------------------- */
#modal-overlay,
#markdown-modal-overlay {
  position: fixed; inset: 0;
  background: rgba(0,0,0,.5);
  display: flex; align-items: center; justify-content: center; z-index: 1000;
}
#instructions-modal, #markdown-modal {
  background: #fff; border-radius: 8px; box-shadow: 0 0 15px rgba(0,0,0,.3);
  position: relative; padding: 20px;
}
#instructions-modal { width: 500px; max-width: 90%; padding: 30px; }
#markdown-modal { width: 80%; max-height: 80%; overflow-y: auto; }
#markdown-modal pre { margin-top: 10px; }
.close-btn { position: absolute; top: 8px; right: 12px; font-size: 24px; font-weight: bold; cursor: pointer; }

.hidden, [hidden] { display: none !important; }

/* -------------------------
   Chat area
-------------------------- */
.chat-wrap {
  display: grid; grid-template-rows: 1fr auto; gap: .75rem;
  height: calc(100vh - 120px);
}

.messages {
  background: #fff; border: 1px solid var(--border);
  border-radius: 16px; padding: 20px; overflow: auto;
}
.msg { width: 100%; display: flex; margin: .75rem 0; }
.msg.user { justify-content: flex-end; }
.msg.bot { justify-content: flex-start; }

.bubble {
  max-width: min(72ch, 100%);
  line-height: 1.6; white-space: pre-wrap; word-wrap: break-word;
}
.user .bubble {
  background: var(--user-bubble); color: var(--ink);
  border: 1px solid var(--user-border);
  border-radius: 14px; padding: .75rem 1rem;
}
.bot .bubble { background: transparent; border: none; padding: 0; color: var(--ink); }
/* Rendered markdown niceties */
.bot .bubble { white-space: normal; }
.messages h1, .messages h2, .messages h3 { margin: .6rem 0 .4rem; }
.messages p { margin: .5rem 0; }
.messages ul, .messages ol { margin: .5rem 0 .5rem 1.25rem; }
.messages code { font-family: ui-monospace, SFMono-Regular, Menlo, monospace; font-size: .95em; }
.messages pre { background: #f8fafc; border: 1px solid #e5e7eb; border-radius: 10px; padding: .8rem; overflow: auto; }
.messages a { color: var(--accent); text-decoration: underline; }
.messages.drag-over { outline: 2px dashed #999; outline-offset: 4px; }

/* Thinking */
.thinking { display: none; color: var(--muted); font-size: .9rem; margin-left: .5rem; }
.thinking.show { display: inline-flex; align-items: center; gap: .35rem; }
.thinking .dots { display: inline-block; width: 28px; text-align: left; }
.thinking .dots>span {
  display: inline-block; width: 6px; height: 6px; margin: 0 1px;
  background: currentColor; border-radius: 50%;
  animation: thinking-bounce 1.2s infinite ease-in-out both;
}
.thinking .dots>span:nth-child(2){ animation-delay: .15s; }
.thinking .dots>span:nth-child(3){ animation-delay: .30s; }
@keyframes thinking-bounce {
  0%,80%,100% { transform: translateY(0); opacity:.35; }
  40% { transform: translateY(-3px); opacity:1; }
}

/* -------------------------
   Chat composer (namespaced)
-------------------------- */
.chat-composer {
  display: grid; grid-template-columns: 1fr; gap: .75rem;
}

.chat-composer #prompt {
  min-height: 120px; padding: .75rem .9rem;
  border: 1px solid #d9d9e3; border-radius: 10px;
  resize: vertical; box-sizing: border-box;
  font: 16px/1.5 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
}

.chat-composer__controls {
  display: flex; align-items: center; gap: .5rem;
}
.chat-composer__spacer { flex: 1; }

.chat-composer__icon-btn {
  all: unset;
  display: inline-flex; align-items: center; justify-content: center;
  width: 36px; height: 36px; border-radius: 999px; cursor: pointer;
}
.chat-composer__icon-btn:hover { background: #f2f2f5; }
.chat-composer__icon-btn:active { background: #e9e9ef; }

.chat-composer__send {
  padding: .6rem 1rem; border: 0; border-radius: 12px;
  background: #2266ff; color: #fff; font-weight: 700; cursor: pointer;
}

.chat-composer__preview {
  display: inline-flex; align-items: center; gap: .5rem;
  padding: .35rem .45rem; border: 1px solid #e5e7f0; border-radius: 12px;
  background: #f8f9ff; width: -moz-fit-content; width: fit-content;
  max-width: 100%; box-sizing: border-box;
}
.chat-composer__preview img {
  width: 72px; height: 72px; object-fit: cover; border-radius: 10px;
}
.chat-composer__remove {
  all: unset;
  display: inline-flex; align-items: center; justify-content: center;
  width: 24px; height: 24px; min-width: 24px; min-height: 24px;
  border-radius: 999px; border: 1px solid #cfd2dc; background: #fff;
  color: #333; font-size: 14px; line-height: 1; cursor: pointer; flex: none;
}
.chat-composer__remove:hover { background: #f6f6fb; }

.chat-composer__hint { margin: 0; color: #6b6b7a; font-size: .9rem; }


/* Markdown images: responsive width, capped height, keep aspect */
.messages .bubble img {
  display: block;
  max-width: 100%;   /* never exceed the bubble width */
  height: auto;      /* preserve aspect ratio when width is constrained */
  max-height: 60vh;  /* also cap by viewport height */
  object-fit: contain;
  margin: .5rem auto;   /* center + breathing room */
  border-radius: 8px;
  cursor: zoom-in;      /* optional: hint that itâ€™s clickable */
}


/* Thumbnails shown inside the USER bubble */
.user .bubble .attachments {
  display: flex;
  flex-wrap: wrap;
  gap: .5rem;
  margin-bottom: .5rem;          /* space between thumbs and text */
}

.user .bubble .attachments img {
  width: 80px;
  height: 80px;
  object-fit: cover;
  border-radius: 8px;
  border: 1px solid var(--user-border);
  background: #fff;
}
